{% extends "base.html" %}

{% block content %}
<div class="container mt-5">
    <h2>Predict Injury Type</h2>
    <form id="prediction-form">
        <div class="mb-3">
            <label for="gender" class="form-label">Gender</label>
            <select class="form-control" id="gender" name="gender" required>
                <option value="Mand">Mand</option>
                <option value="Kvinde">Kvinde</option>
            </select>
        </div>
        <div class="mb-3">
            <label for="age" class="form-label">Age</label>
            <select class="form-control" id="age" name="age" required>
                <option value="0-17 År">0-17 År</option>
                <option value="18-24 År">18-24 År</option>
                <option value="25-44 År">25-44 År</option>
                <option value="45-64 År">45-64 År</option>
                <option value="65 År og derover">65 År og derover</option>
            </select>
        </div>
        <div class="mb-3">
            <label for="area" class="form-label">Area</label>
            <select class="form-control" id="area" name="area" required>
                <option value="Region Hovedstaden">Region Hovedstaden</option>
                <option value="Region Sjælland">Region Sjælland</option>
                <option value="Region Syddanmark">Region Syddanmark</option>
                <option value="Region Midtjylland">Region Midtjylland</option>
                <option value="Region Nordjylland">Region Nordjylland</option>
            </select>
        </div>
        <div class="mb-3">
            <label for="vehicle" class="form-label">Type of Vehicle</label>
            <select class="form-control" id="vehicle" name="vehicle" required>
                <option value="Almindelig personbil">Almindelig personbil</option>
                <option value="Taxi">Taxi</option>
                <option value="Køretøj 0-3.500 kg under udrykning">Køretøj 0-3.500 kg under udrykning</option>
                <option value="Varebil 0-3.500 kg.">Varebil 0-3.500 kg.</option>
                <option value="Lastbil over 3.500 kg.">Lastbil over 3.500 kg.</option>
                <option value="Bus">Bus</option>
                <option value="Motorcykel">Motorcykel</option>
                <option value="Knallert 45">Knallert 45</option>
                <option value="Knallert">Knallert</option>
                <option value="Cykel">Cykel</option>
                <option value="Fodgænger">Fodgænger</option>
                <option value="Andre">Andre</option>
            </select>
        </div>
        <button type="submit" class="btn btn-primary">Submit</button>
    </form>
    <div id="prediction-result" class="mt-3"></div>
</div>

<script>
    $(document).ready(function() {
        $('#prediction-form').on('submit', function(event) {
            event.preventDefault();

            const genderMap = { 'Mand': 'Mænd', 'Kvinde': 'Kvinder' };
            const gender = genderMap[$('#gender').val()];
            const age = $('#age').val();
            const area = $('#area').val();
            const vehicle = $('#vehicle').val();

            $.ajax({
                url: '/predict_injury',
                method: 'POST',
                contentType: 'application/json',
                data: JSON.stringify({ gender: gender, age: age, area: area, vehicle: vehicle }),
                success: function(response) {
                    $('#prediction-result').html('<h4>Predicted Injury: ' + response.prediction + '</h4>');
                },
                error: function(error) {
                    $('#prediction-result').html('<h4>Error: Unable to get prediction</h4>');
                }
            });
        });
    });
</script>
{% endblock %}
